<!DOCTYPE HTML >
<html>
<head>
	<title>The network</title>
	
	<link rel="stylesheet" type="text/css" href="normalize.css" />
	<link rel="stylesheet" type="text/css" href="styles.css" />
	<script type="text/javascript" language="javascript" src="js/DataStore.js"></script>
	<script type="text/javascript" language="javascript" src="js/PostsController.js"></script>
	
	<script type="text/javascript" language="javascript" src="components/base-component.js"></script>
	<script type="text/javascript" language="javascript" src="components/posts-page.js"></script>
	<script type="text/javascript" language="javascript" src="components/page-menu.js"></script>
	<script type="text/javascript" language="javascript" src="components/user-account-panel.js"></script>
	<script type="text/javascript" language="javascript" src="components/user-profile-pic.js"></script>
	<script type="text/javascript" language="javascript" src="components/user-post.js"></script>
	<script type="text/javascript" language="javascript" src="components/post-modal.js"></script>
	<script type="text/javascript" language="javascript" src="components/post-form.js"></script>
	<script type="text/javascript" language="javascript" src="components/modal-confirm-content.js"></script>
	
	<script type="text/javascript" language="javascript" src="data/users.json"></script> 
	<script type="text/javascript" language="javascript" src="data/posts.json"></script> 
	
	 
	<script type='text/javascript'>
	
		var ls = window.localStorage;
	
		const mainCSS = new CSSStyleSheet()
		
		mainCSS.replace( "@import url( normalize.css ); @import url( styles.css );" );
		
		
		window.onload = function(e){
			LoadData();
			Render();		
		}
		
		var currentUser = null;
		const currentUserId = 5;
		function CurrentUser() {
			if(currentUser == null) {
				currentUser = DataStore.GetDataById("Users", currentUserId);
			}
			return currentUser;			
		}
		
	
		function LoadData(){				
			if (ls.getItem('Users') == null) {
				ls.setItem("Users", JSON.stringify(users));
			}
			if (ls.getItem('Posts') == null) {
				ls.setItem("Posts", JSON.stringify(posts));
				//loadJSON("data/posts.json");
			}				
		}
	
	//{id: 1, username: "James Bond", pic: "images/profile/Sean-Connery-as-James-Bond.jpg", about: "Secret Agent, for MI6 code name 007, need I say more?"}	

		
	//{id: 1, userId: 1, date: "", content: "Love wine? Love food? Love to win an iPad 2 with gâ€¦winery & Dine IA restaurant. http://bit.ly/xQ4Ls8", comments: Array(1)}

		function Render(){	
			var page = document.querySelector("#page");
			var elem = document.createElement("posts-page");
			elem.setAttribute("data-user-id", CurrentUser().id);
			elem.setAttribute("data-user-name", CurrentUser().username);
			elem.setAttribute("data-user-pic", CurrentUser().pic);	
			page.appendChild(elem);
			
			var header = document.querySelector("#header");
			var elem = document.createElement("page-menu");
			elem.setAttribute("data-user-id", CurrentUser().id);			
			elem.setAttribute("data-user-pic", CurrentUser().pic);	
			header.appendChild(elem);
			
		}
		
	
		
		function loadJSON(path) {
			var xhr = new XMLHttpRequest();
			xhr.open('GET', path, true);
			xhr.responseType = 'blob';
			xhr.onload = function(e) { 
			  if (this.status == 200) {
				  var file = new File([this.response], 'temp');
				  var fileReader = new FileReader();
				  fileReader.addEventListener('load', function(){
					   console.log(fileReader.result);
				  });
				  fileReader.readAsText(file);
			  } 
			}
			xhr.send();
		}
	</script>
</head>
<body>	
	<div id="header">
		<div id="logo">
			<img src="images/logo.png" alt="the network"/>
		</div>	
		<div id="search">
			<form method="get" action="#">
				<input type="search" name="terms" placeholder="Search...."/>
				<input type="submit" value="Go"/>
			</form>
		</div>
	</div>	
	<div id="page">
		
	</div>	
	<footer>
		<p>This is a footer message</p>
	</footer>		
	
	
</body>
</html>